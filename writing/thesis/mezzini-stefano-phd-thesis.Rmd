---
bibliography: 'phd-refs.bib'
csl: '../freshwater-biology.csl'
subparagraph: yes # needed for \usepackage[small]{titlesec}
header-includes:
    - \usepackage{setspace}\doublespacing # change default spacing
    - \usepackage{indentfirst} # add indent to first line of each paragraph
    - \pagenumbering{gobble} # remove numbering from title page
    - \usepackage{pdfpages} # to append pdfs to the thesis
    - \usepackage[small]{titlesec} # for smaller headings
    - \usepackage{wrapfig} # to wrap text around figures
    - \usepackage{caption}
    # smaller caption text, less space above and below caption
    - \captionsetup[figure]{font=scriptsize, aboveskip=4pt, belowskip=-20pt}
    # not currently needed, but keeping for reference
    # - \usepackage{gensymb}
    # - \usepackage{geometry} \geometry{margin=1in, lmargin=1.5in}
    # - \usepackage{float}
    # - \usepackage{afterpage}
    # - \usepackage{ragged2e}
output:
  bookdown::pdf_document2:
    number_sections: true
    toc: false # added manually later
    fig_caption: true
    extra_dependencies: ['float']

# bookdown-specific arguments
site: bookdown::bookdown_site # needed to build the book
config_file: '_bookdown.yml'
---

```{r, include=FALSE}
TITLE <- 'Linking resource abundance and environmental stochasticity with animal space use using continuous-time stochastic processes'
knitr::opts_chunk$set(echo = FALSE, out.extra = '')
library('dplyr')
```

```{r wrap-figure-function, include = FALSE}
# code modified from https://stackoverflow.com/questions/54100806/r-markdown-how-do-i-make-text-float-around-figures

# this chunk is needed to wrap text around or beside figures

defOut <- knitr::knit_hooks$get('plot')  # save the default plot hook

knitr::knit_hooks$set(plot = function(x, options) {  # set the new plot hook ...
  
  x <- defOut(x, options)  # first apply the default hook
  
  # if wrapfigure options are given, create the new opening string for the wrapfigure
  # environment using custom figure alignment and text width
  if(!is.null(options$wrapfigure)) {
    
    # options must be numeric, they cannot be characters
    wf <- sprintf('\\begin{wrapfigure}{%s}{%g\\textwidth}',
                  options$wrapfigure[[1]], # figure alignment
                  options$wrapfigure[[2]]) # caption width relative to text width
    x  <- gsub(pattern = '\\begin{figure}', # and replace the default one with it
               replacement = wf,
               x = x,
               fixed = TRUE) # pattern is a string, so evaluate as is
    x  <- gsub(pattern = '{figure}', # also replace the environment ending
               replacement = '{wrapfigure}',
               x = x,
               fixed = TRUE)
  }
  return(x)
}
)

# chuck options used to wrap figures:
## fig.align = "right":          align figures right
## out.width = "0.5\\textwidth": output width = 0.5 * the width of the text
## wrapfigure = list("R", 0.5)   wrap caption to right, caption width = 0.5 text width
```

<!-- http://www.personal.ceu.hu/tex/breaking.htm for breaking lines and pages-->

<!-- center text, triple spacing, leave blank lines between sections -->

\begin{center}

\setstretch{3}

\textbf{`r toupper(TITLE)`}

by

Stefano Mezzini

\bigskip

B.Sc. Hons. Biology, University of Regina, 2021

B.Sc. Statistics, University of Regina, 2021

\bigskip

A THESIS SUBMITTED IN PARTIAL FULFILLMENT OF

THE REQUIREMENTS FOR THE DEGREE OF

DOCTOR OF PHILOSOPHY

in

THE COLLEGE OF GRADUATE STUDIES

(Biology)

THE UNIVERSITY OF BRITISH COLUMBIA

(Okanagan)

`r paste(month.name[lubridate::month(Sys.Date())], lubridate::year(Sys.Date()))`

© Stefano Mezzini, `r lubridate::year(Sys.Date())`

\end{center}

\doublespacing

\newpage

<!--
***NOTES:***

- not using the style guideline at https://github.com/jepa/ubcdown because it requires cloning and forking the repository
- UBC-V style: https://faculty.washington.edu/mforbes/projects/ubcthesis/
- TU Delft, Netherlands, template https://www.tudelft.nl/huisstijl/downloads
- contact Sunil Suresh, Kristy Baxter, and Mathew Vis-Dunbar once I've made a template
- see https://gradstudies.ok.ubc.ca/theses-supplementary-deposit/ for how to submit and store supplementary materials to support transparency and reproducibility, as well as SI from other theses
- underline entire lines with committee members and examiners for them to sign?

-->

\pagenumbering{roman} <!-- use roman numerals -->

\setcounter{page}{2} <!-- cover page is page i, so start from ii -->

\textbf{The following individuals certify that they have read, and recommend to the College of Graduate Studies for acceptance, a thesis entitled:\newline
\textit{`r TITLE`},\newline
submitted by Stefano Mezzini in partial fulfillment of the requirements of the degree of Doctor of Philosophy.}

\bigskip

**Michael J. Noonan** \hfill`r paste0(rep('_', 20), collapse = '')`\newline
Supervisor

**Adam T. Ford** \hfill`r paste0(rep('_', 20), collapse = '')`\newline
Supervisory Committee Member

**Jason Pither** \hfill`r paste0(rep('_', 20), collapse = '')`\newline
Supervisory Committee Member

<!--
**University Examiner.** \hfill`r paste0(rep('_', 20), collapse = '')`\newline
University Examiner

**External Examiner.** \hfill`r paste0(rep('_', 20), collapse = '')`\newline
External Examiner
-->

<!--Additional Committee Members include:

Click or tap here to enter text.
Supervisory Committee Member

Click or tap here to enter text.
Supervisory Committee Member.-->

\newpage

# Abstract {-}

<!-- The abstract is a concise and accurate summary of the research contained in the thesis. It states the problem, the methods of investigation, and the general conclusions. It should not contain tables, graphs or illustrations. It must not exceed 350 words, and should contain relevant keywords that will facilitate automated information retrieval. There may only be one abstract for the entire thesis. -->

```{r}
abstract <- "The ability to move allows animals to access more resources and decrease the risk of mortality or injury from various threats, including predation and competition. However, most motile animals depend on movement to achieve an energetic balance, survive, and reproduce. Animals' spatial needs depend on a multitute of factors, including resource abundance, competitive pressure, predation, weather, and climate. The effects of many of these factors have been studied extensively, but the effects of environmental heterogeneity and unpredictability remain largely understudied. This thesis aims to quantify how resource abundance and environmental variation affect animals' spatial needs using theoretical arguments, computational simulations, and a large animal movement dataset of over 1500 individuals from more than 75 species. To this end, this thesis will produce a new global measure of environmental variance which will be used to quantify the effect of environmental heterogeneity and stochasticity on animals' spatial needs while accounting for spatiotemporal trends and correlations within populations and species. The animals' movement will be modeled using continuous-time stochastic movement models. The effects of environmental variance on animal's spatial needs will be estimated using hierarchical generalized additive models that account for common trends between taxonomic groups and populations. The work will be carried out within a framework that recognizes the value of different forms of knowledge, including Traditional Indigenous Knowledge, and it will incorporate Traditional Indigenous Knowledge when possible. Overall, I expect spatial needs to be lower in areas with higher resource abundance and lower environmental variance. However, I also expect the effects of resource abundance and environmental variance to depend on the species and ecosystems of interest. Thus, the average trends between species may not be representative of individual populations and species."

abstract <- if_else(stringi::stri_count_words(abstract) < 350,
                    abstract,
                    paste0('# ABSTRACT IS LONGER THAN 350 WORDS (',
                          stringi::stri_count_words(abstract),
                          ' WORDS).'))
```

`r abstract`

\newpage

# Lay Summary {-}

<!-- The lay summary explains the key goals and contributions of the research/scholarly work in terms that can be understood by the general public. It does not use technical terms and discipline-specific language. It must not exceed 150 words in length. -->

```{r}
lay_summary <- "Many factors affect how much space animals need to survive and reproduce. The effects of many factors have been studied extensively, such as resource abundance, competitive pressure, predation, weather, and climate. However, the effects of environmental heterogeneity and unpredictability remain understudied. This thesis aims to quantify how resource abundance and environmental variation affect animals' spatial needs using a large animal movement dataset. This thesis will produce a global measure of environmental variance which will be used to quantify the effect of such variance on animals' spatial needs while accounting for spatiotemporal trends and correlations within populations and species. The work will be carried out while recognizing the value of different forms of knowledge, including Traditional Indigenous Knowledge. I expect spatial needs to be lower in areas with higher resource abundance and lower environmental variance, although this will likely depend on the species and ecosystems of interest."

lay_summary <- if_else(stringi::stri_count_words(lay_summary) < 150,
                       lay_summary,
                       '# LAY SUMMARY IS LONGER THAN 150 WORDS.')
```

`r lay_summary`

\newpage

<!--
# Preface {-}

The preface is a statement indicating the relative contributions of all collaborators and co-authors (including supervisors and members of the supervisory committee) of publications or material submitted for publication, emphasizing details of the student's contribution and stating the proportion of research and writing conducted by the student. It should include:
* Identification and design of the research program.
* Performance of the various parts of the research.
* Analysis of the research data.
* Preparation of manuscripts, if any.
* A list of any publications or submissions arising from work presented in the thesis including the title of the article and name of the publisher (only if the article has been accepted or published), and the chapter(s) of the dissertation in which the work is located.
* The name of the particular UBC Research Ethics Board, and the Certificate Number(s) of the Ethics Certificate(s) obtained, if ethics approval was required for the research.


\newpage
-->

# Foreword {-}

## Two-eyed seeing: Recognizing Traditional Indigenous Knowledge {-}

The lands managed and protected by Indigenous Peoples are often markedly different from those inhabited by urban societies. While recognizing that there is great diversity between Indigenous Peoples (as well as other colonized Peoples), it is important to recognize that many hold great knowledge on how to live sustainably, safeguard environments, and protect biodiversity [@schuster_vertebrate_2019], and have been doing so for millennia. Yet, their leaders and representatives are seldom included in conservation-related decision-making. Instead, many Western institutions often dismiss, ignore, and contradict the ancestral and traditional Knowledge of Indigenous and colonized Peoples [@smith_decolonizing_2021; @kimmerer_braiding_2020]. The development of Western science is frequently assumed to clash with the (often sacred) Knowledge many colonized Peoples hold. Western science is often viewed as more objective, methodical, and unbiased than traditional Knowledge, and as such Western institutions and people often consider it to be superior to Indigenous Knowledge [@smith_decolonizing_2021]. However, it is common for Western institutions to (reluctantly) reach similar, if not identical, conclusions as those held by Indigenous people [@bennett_evidence_2021; @smith_decolonizing_2021; @kimmerer_braiding_2020]. The refusal to recognize traditional Knowledge and cooperate with non-Western institutions often results in a loss of time, resources, and funds to the Western institutions and severe damage to the Land the institution operated on, as well as to the people who's ancestors inhabited the region for millennia [@smith_decolonizing_2021]. The development of Western science at the exclusion of Indigenous Peoples perpetuates colonialism and brings harm all parties involved, and reinforces "research" as the dirtiest word for many Indigenous Peoples [@smith_decolonizing_2021, p. 1]. The sharing, development, recognition, and ownership (or lack thereof) of knowledge (and Sacred Knowledge) are core aspects of imperialism [@smith_decolonizing_2021, p. xii].

The concept of *two-eye seeing* refers to an approach to knowledge and growth that braids Indigenous Knowledge and science together with Western science [@kutz_two-eyed_2019; @kimmerer_braiding_2020]. Since Traditional Indigenous Knowledge tends to be qualitative, while biological sciences tend to be quantitative, connecting the two is not always simple [@bowles_threepronged_2021]. One possibility, however, is to use Traditional Knowledge to create properly informed Bayesian priors [@bolstad_introduction_2017]. The validity of the priors can be ensured using prior predictive modeling [@mcelreath_statistical_2016] to select priors that align with the Traditional Knowledge. This practice is not new [@girondot_bayesian_2015; @belisle_local_2018], but it is rarely used, despite it aligning well with the philosophy of Bayesian statistics.

Although this project does not focus on Indigenous Knowledge or Data, I intend to carryout the work with an anti-imperial and anti-colonial stance, to combat problematic and questionable practices and views (rather than risking perpetuating them). I recognize my ignorance in the field in the hopes of receiving valuable critiques, direction, and suggestions. During the project, I intend connecting with local Indigenous groups and Nations (including Westbank First Nation) to offer help in related fields and exchange knowledge (while recognizing that I do not have the right to all knowledge and that many forms and sources of Knowledge are sacred). Regardless of whether collaborations will be possible, I will actively work on removing any form of colonial bias in my work and perspectives while also combating colonialism, imperialism, and other forms of oppression.

<!--
- https://focus.science.ubc.ca/stats-660805dd930a
- *A-spatial-overview-of-the-global-importance-of-Indigenous-lands-for-conservation*
- *Native knowledge for native ecosystems*
- *Searching for synergy integrating traditional and scientific ecological knowledge in environmental science education*
- *The Role of Indigenous Burning in Land Management*
- calls to action for scientists: @wong_towards_2020
- weaving TIK and Western knowledge: @tengo_weaving_2017
- *Weaving Indigenous knowledge systems and Western sciences in terrestrial research, monitoring and management in Canada: A protocol for a systematic map* [@henri_weaving_2021]
- *Indigenizing the North American Model of Wildlife Conservation* [@hessami_indigenizing_2021]
-->

\newpage

\tableofcontents

\newpage

\listoftables

\newpage

\listoffigures

\newpage

# Acknowledgements {-}

<!-- In this section you can acknowledge the extent to which assistance has been given by members of staff, fellow students, data technicians, editors, and/or others; recognize the supervision and advice given by your supervisor and committee members; acknowledge colleagues with whom you have written journal articles. -->

I would like to thank Dr. Noonan for offering me the opportunity to pursue a PhD with such an interesting project with cutting-edge statistical methods for movement ecology. I have already learned a lot and I expect I will learn much more.

I would like to thank Dr. Ford and Dr. Pither for agreeing to be on my committee. Your feedback and mentorship will help me ensure this project is relevant and directly applicable to current issues regarding conservation and biogeography.

I would like to thank Sandra Fox for providing me with resources to ensure my perspective and work are inclusive and supportive of different ways of knowing, including Indigenous Knowledge, and that my attitude remains anti-colonial and anti-imperial.

\newpage

# Dedication {-}

<!-- The dedication is usually quite short, and is a personal rather than academic recognition. You can use any font or language you wish for the dedication page. -->

*A is Terras chi m'ant imbuconau e m'ant donau su logu aundi bivi, imparai, e giogai.*

*Alle Terre che mi hanno nutrito e dato un luogo dove vivere, imparare e giocare.*

To the Lands that have nourished me and given me a place to live, learn, and play.

\newpage

\pagenumbering{arabic} <!-- change numbering format -->

\setcounter{page}{1} <!-- start numbering from 1 -->

<!-- to refer to a section, add {#section-name} after the heading, and reference using \@ref(section-name) -->

<!--chapter:end:index.Rmd-->

\newpage

# Chapter 1: Literature review and quantitative predictions

> *"If [one] will begin with certainties, [they] shall end in doubts; but if [they] will be content to begin with doubts, [they] shall end in certainties" (Bacon 1605)*

<!-- (Read http://www.zo.utexas.edu/courses/bio373/chapters/Chapter5/Chapter5.html) -->

@blackwell_heterogeneity_2007:

* "spatiotemporal correlation" and "heterogeneity" instead of "patchiness"
* sometimes patches are actually just correlated areas rather than real patches

@hanya_not_2006: the home range of Japanese macaques (*Macaca fuscata*) varied between seasons due to changes in food abundance and quality

@tucker_large_2019: large birds fly longer distances in more homogeneous areas

@kouba_home_2017: non-monotonic, nonlinear relationship between prey abundance and home range size

to do:
- flesh out the paper with sections, add headers for missing sections with bullet points on missing points
- download NDVI data for tapir from rgee -> fit brms model -> perform analysis on tapir movement parameters
- add a note on how sims could be different: could add renewal time ~ Gamma(), 

## Home ranges as proxies for animals' needs

The ability to move provides animals with the capacity to respond rapidly and continuously to heterogeneous and changing environments. Animals may move to search for resources (e.g., as food, nutrients, water, heat, a new den or nesting spot), a mate, or a new group. Movement also allows animals to escape predation or dangerous competition, and it allows them to defend resources and territory, too. Thus, we can estimate changes in animals' movement and space use as a proxy for many needs, rather than measuring changes in the various individual needs [@nathan_movement_2008].

<!-- place figures before the paragraph they are referred to so wrapfigure places them beside the paragraph -->

```{r hr-quantiles, fig.cap="Inset: Simulated movement of an animal with a stationary home range centroid. The colored areas indicate the home range estimates for different quantiles. The magenta area indicates the core home range (50\\%), while the orange and yellow areas indicate the 75\\% and 95\\% home ranges, respectively. Main figure: Home range area as a function of utilization quantile. Note that as the quantile approaches 1, home range size approaches infinity, since if the animal was to move for an infinite amount of time, it would cover all possible space.", out.width = '0.4\\textwidth', fig.align = 'right', wrapfigure = list('R', 0.4)}
knitr::include_graphics('../../figures/hr-quantiles.png')
```

In this context, the concept of a home range (HR) has a long history in ecological research as an indicator of the space an animal requires to satisfy its essential requirements during a period of time [@burt_territoriality_1943, see figure \@ref(fig:hr-quantiles)]. These include both energetic needs and reproductive needs (which are not limited to finding a mate, since offspring require energy a safe location to develop in, too), but exploratory movement outside the habitual HR are generally excluded. However, for an animal to have what we may consider a HR, the animal must remain in a stable "home" area for long periods of time [@noonan_comprehensive_2019]. That is, the animal must be range-resident and the HR must have a stable centroid. Stable centroids may be concrete locations such as the dens or nests of central place foragers [*sensu* @orians_theory_1979], or they may be abstract points such as the center of an individual’s foraging grounds. Thus, animals with an unstable centroid would not be appropriate for HR analysis. In addition, while an individual's HR may change over time (e.g., following a forest fire or a flood<!-- add empirical examples of range shifts -->), it should remain stable during the period of observation. Ideally, properties of the HR (e.g., range size and structure) are representative of any new HR the animal will move to if the current one becomes inhospitable. For instance, an animal with a HR area of 1 km^2^ would be expected to occupy a comparably sized area if it were displaced by a fire, assuming that the new habitat is sufficiently similar. Similarly, the movement of the individual within the HR (e.g., range crossing time $\tau_p$, directional persistence $\tau_v$) are also expected to be representative. Nomadic [e.g., @morato_space_2016; @nandintsetseg_variability_2019] or migrating [e.g., @jonzen_rapid_2006; @geremia_migrating_2019; @abrahms_memory_2019] animals are thus generally not considered range resident, and tracking periods should be long enough to provide a representative sample of the animal's spatial needs.

```{r tapir-hr, fig.cap="Movement of a tapir during a monitoring period of approximately 3 years (1997-07-10 to 2000-06-08) used in the work by Medici $et~al.$ (2022). Different subsamples may result in different estimates of home range size and centroid (a, b; each span 100 days), so neither subsample is necessarily representative of the space the animal used over the entire monitoring period (c).", out.width = '0.5\\textwidth', fig.align = 'right', wrapfigure = list('R', 0.5)}
knitr::include_graphics('../../figures/hr-and-lifespan.png')
```

In the case of a species or population where spatial needs change over the animals' lifetimes (figure \@ref(fig:tapir-hr)), one may define HR as a function of the animal's life stages (with distinct discrete HRs) or as a function of age (so HR changes smoothly). In either case, the accuracy of the estimate will depend strongly on the length of the observation period as well as the measurement frequency [@noonan_comprehensive_2019]. Data from a portion of an animal's life may be sufficient if it is representative the animal's movement or if inference is limited to the period(s) for which data is available.

<!-- see https://doi.org/10.1186/s40462-019-0187-z regarding HR, energetics, and movement along paths -->

There are many factors which may affect animal's spatial requirements and how they use their HR [*sensu* @nathan_movement_2008]. In particular, resource abundance is often assumed to be inversely proportional to HR size (or some function of it), such that regions with higher abundance correspond to smaller spatial needs, since animals do not have to range over extensive areas to meet the energetic requirements. However, the effect of many other factors likely depends on how an animal responds to them. For instance, competition may push individuals to explore other areas and expand their HR [@jetz_scaling_2004], but strong and consistent competition paired with territorial defense [e.g., wolves, @rich_anthropogenic_2012; feral cats, @bengsen_feral_2016; capuchin monkeys, @torrez-herrera_monkeys_2020] may also prevent them from doing so. Similarly, predation may force animals to move more frequently to escape predators, or it may prevent them from venturing too far from the safety of their den (the HR's centroid) too often [@suraci_beyond_2022]. Patch quality, size, fragmentation, and heterogeneity may cause animals to explore more patches if some are of low value, too small, too disconnected, or too variable [@fahrig_is_2019], but high diversity may also decrease HR size [@fox_niche_1981; @lucherini_habitat_1996]. Similarly, patch connectivity and ease of movement may widen HRs by decreasing the energetic cost of movement and favoring exploration [@dickie_resource_2022], or they may shrink HRs by decreasing the energetic cost of movement while increasing encounter rates with resources [@martinez-garcia_how_2020; @bartumeus_influence_2008; @visser_plankton_2006]. However, not all animals take advantage of linear features or higher predictability in human-altered habitats. @noonan_roads_2021 found that giant anteaters (*Myrmecophaga tridactyla*) in Brazil did not use roads to reduce movement costs or increase movement speed. Instead, roads increased anteater mortality because the animals were attracted to the high-quality foraging found on roadside habitat. Similarly, @medici_movement_2022 found that the movement of tapirs (*Tapirus terrestris*) was unaffected by anthropogenic activity or habitat type.

<!-- Animals can be simplified to systems whose needs (input) and (inter)actions (output) depend on the resources and energy required to move, survive and reproduce. , and used to move: more arduous areas may require more energy to move -->

<!--
Notes:

notation:
- $\mu$ mean movement process
- $\epsilon$ movement noise, exploratory movements
- $\sigma$ volatility
- $\tau_p$ positional autocorrelation, mean time reversion to the mean (origin), range crossing time
- $tau_v$ velocity autocorrelation

protective/defensive adaptations peaks at intermediate levels of competitor density/spatial resource density/spatiotemporal clumping. At low competition, there's no need for defense and the cost (e.g., energetic) and risk (e.g., wounds) outweigh the benefit, while at high values the cost and risk become too high and they outweigh the benefit [@grant_whether_1993].

See *The effects of phenological mismatches on demography*.

@rickbeil_plasticity_2019:
- Many species use seasonal migration to track emerging resources (Fryxell, Greever, & Sinclair, 1988), reduce predation risk (Hebblewhite & Merrill, 2009), or avoid disease and parasites (Altizer, Bartel, & Han, 2011).
- Migrations to track resources are often timed to coincide with peak plant and insect emergence (Aikens et al., 2017; Jonzén et al., 2006; Merkle et al., 2016)
- there is growing evidence that some [bird] populations are adjusting their behavior, suggesting that migration, specifically migration timing, may be more plastic than previously expected (Jonzén, Hedenstrom, & Lundberg, 2007; Jonzén et al., 2006; Lameris et al., 2018) and highlighting a potential measure of resilience in the face of climate change
- Elk departed earlier from highly-productive areas? This goes against the idea that animals move as a consequence of need. But maybe the elk simply left when they had enough stored energy to face the migration. Maybe elk migration is triggered when they have sufficient energy (if the weather is still not too harsh).
- Elk left early when exposed to hunting more
-->

The effects of resource abundance on animals' spatial needs have been studied by many in the last century. Multiple general hypotheses have been postulated based on (relatively) small-scale empirical studies [e.g., @burt_territoriality_1943; @southwood_habitat_1977; @lindstedt_seasonality_1985; @grant_whether_1993; @lucherini_habitat_1996; @nilsen_can_2005; @bengsen_feral_2016], and supported (or questioned) by more recent work with larger, higher-resolution datasets [e.g., @jonzen_rapid_2006; @wolkovich_warming_2012; @falcon-cortes_hierarchical_2021; @nathan_big-data_2022; @dickie_resource_2022] and simulations [@blackwell_heterogeneity_2007; @quaglietta_simulating_2019; @tucker_humaninduced_2021]. Recently, the amount of movement data which can be modeled at once has increased due to improvements in the quality and affordability of tracking equipment [@rutz_new_2009], together with growing propensity (and requirements) to share data openly on various open data platforms such as Movebank [@kranstauber_movebank_2011; @kays_movebank_2022; but see @roche_public_2015], as well as the development of high-level modeling software [e.g., @r_core_team_r_2021; @wood_generalized_2017; @burkner_brms_2017; @burkner_advanced_2018]. The abundance of data and statistical software allows researchers build on current knowledge by building increasingly complex hypotheses and models and testing them empirically and quantitatively.

While it is understood that an animal's spatial use strongly depends on the amount of resources and energy the animal can obtain from their habitat, estimates are often restricted to single populations or at most single species. To my knowledge, there are currently no large-scale estimations of vertebrate (or mammalian) space use as a function of resource availability. Additionally, little attention is often given to the stochasticity of resource availability or, more generally, habitat heterogeneity *and* stochasticity [but see @lucherini_habitat_1996; @nilsen_can_2005; @rizzuto_forage_2021]. This thesis aims to disentangle the effects of resource abundance and environmental stochasticity on animal space use using statistical models which are based on continuous-time stochastic processes and are insensitive to sampling frequency and spatiotemporal or taxonomic autocorrelation in the data. Findings from this thesis will provide information on how stochasticity has shaped the ecology and evolution of terrestrial mammals and how terrestrial mammals are currently adapting to heterogeneous and changing environments.

\newpage

## Effects of resource availability and productivity on spatial needs

```{r bernoulli-constant, fig.cap="Fictitious example of variation in resource abundance in a heterogeneous but fully predictable environment. (a.) Complete predictability results in guaranteed successes (dots) during each foraging attempt. (b.) Arbitrary definition of $R$ as following a Gamma distribution with shape $k$ and scale $\\theta$, while $S$ follows a Bernoulli distribution with probability of success $p = 1$, since successes always occur (i.e., $P(S = 0) = 0$ implies $S = 1$). Thus, $U = R \\cdot S = R$, so $U$ follows the same distribution as $R$. The shaded green area indicates the probability of obtaining an arbitrarily sufficient amount of resources to survive and reproduce. (c.) Since foraging attempts are guaranteed to be successful, the amount of usable resources will equal the resource abundance. (d.) Since $U = R$, the expected (i.e. average) amount of usable resources is equal to the expected resource abundance.", out.width = '0.6\\textwidth', fig.align = 'right', wrapfigure = list('R', 0.6)}
knitr::include_graphics('../../figures/bernoulli-constant-p.png')
```

Environmental productivity is tightly linked to the amount of space that animals need to cover to obtain the resources they needed to survive and reproduce [@lucherini_habitat_1996; @relyea_home_2000]. While animals' needs vary greatly between taxonomic groups, some needs are essential for most species for survival and reproduction, such as energetic needs [e.g., food, water; see @baldwin_nutritional_1984], habitat needs <!--[-->(e.g., dens, trees, tall grass, breeding grounds, protection from predators and competitors)<!--; see @refs]-->, and maintaining a thermoregulatory balance. The size of a home range, is hypothesized to be proportional to resource abundance [@burt_territoriality_1943], such that spatial needs increase when resources are low, but the relationship is likely not monotonic nor linear, since larger home ranges can result in higher rates of competition and are harder to defend [@grant_whether_1993; @jetz_scaling_2004].

The favorableness of a patch or habitat often depends on a variety of factors, including resource availability, competitive pressure, and predation risk. Let the random variable^[In statistics, random variables indicate random (i.e., unknown) quantities and are indicated with capital letters (e.g., $R$, $S$, $U$). Known values, such as realizations (i.e., known observations) of random variables, are indicated with lower-case letters (e.g., $r$, $s$, $u$). Using this notation we can write the statement "the probability of random variable $R$ taking the value $r$" as $P(R = r)$.] $R$ indicate the amount of *resources* in a particular patch, and let $S$ be the random variable indicating whether or not a patch visit is *successful*. For simplicity, we can let $S$ follow a Bernoulli distribution with probability of success $p$ (which we can write as $S \sim Ber(p)$). Next, let

\begin{equation} \label{u-definition}
U = R \cdot S
\end{equation}

indicate the resources an animal can *use* during a visit. Following this simple model, a patch visit can result in two possible outcomes: if the visit is successful ($S = 1$), an animal can use the entirety of the resource ($U = R \cdot 1 = R$), but if it is unsuccessful ($S = 0$) the animal is unable to access any of the resource ($U = R \cdot 0 = 0$).

If we start by considering the simplistic, though admittedly unlikely, scenario where patches are fully predictable and free of disturbance and competition, such that the animal can access the patches' resources during any visit, i.e., $p = P(S = 1) = 1$. In heterogeneous regions with no stochasticity (figure \@ref(fig:bernoulli-constant)a-b), the favorableness of a location will depend strongly on $R$, so regions with higher $R$ should be preferred (figure \@ref(fig:bernoulli-constant)c). Since all patch visits in fully predictable regions are successful, animals can expect $U$ to be equal to $R$, since $U = R \cdot S = R \cdot 1 = R$ (figure \@ref(fig:bernoulli-constant)d), which implies that $\mathbb E(U) = \mathbb E(R \, S) = \mathbb E(R)$. Since $U = R$, animals can choose their home ranges based on $R$ directly, without having to account for any spatiotemporal stochasticity. Therefore, animals in such regions are likely to maximize fitness and minimize movement costs by spending large amounts of time in highly productive regions, with occasional exploratory movements to different patches. This model is quite simplistic, but its simplicity makes it easy to fit and conceptualize, and it provides a null model against which comparisons can be made. In other words, although it is unlikely for a region to be fully predictable, this model may provide acceptable results when environmental variance is low and has little effect on animal fitness, such as is areas where the variation in $U$, $\mathbb V(U)$, is low relative to its expected value, $\mathbb E(U)$, such that the costs of moving to another favorable area are low or the chances of encountering prey are high. Mathematically, we can say that this simple model may be acceptable when the coefficient of variation, $\sqrt{\mathbb V(R)} / \mathbb E(R)$, is low. Additionally, this model may be the only option when data availability is too low to produce appreciable measures of stochasticity or there is no way to estimate it.

## Effects of environmental variance on spatial needs

There are many sources of environmental change over both time and space. Some are due to repetitive, predictable, or even well-known patterns (such as daily or seasonal changes in temperature and precipitation or the location of different patches), while others are due to infrequent, unpredictable, or poorly-understood events (such as forest fires, the arrival of new competitors, or human activity). In this thesis, I will refer to predictable or known changes in space and time as environmental **heterogeneity** (defined as $\mathbb V(R)$; see the orange distribution in figure \@ref(fig:bernoulli-changing)), while I will use the term **stochasticity** specifically for unpredictable (spatiotemporal) variation (defined as $\mathbb V(S)$; see the blue distribution in figure \@ref(fig:bernoulli-changing))^[Note that both sources of variation, $\mathbb V(R)$ and $\mathbb V(S)$ affect the variation in usable resource, $\mathbb V(U)$, which is represented in the green distribution in figure \@ref(fig:bernoulli-changing).]. For example, the location of (high-yield) apple trees in an orchard and the time at which they produce fruit may be heterogeneous, but predictable. In contrast, the yield produced during a given year may be unpredictable (i.e., stochastic). Environmental sources of *heterogeneity* also include any known spatial variation in patch quality and size, and predictable daily or seasonal changes in temperature throughout the day, while environmental sources of *stochasticity*, include changes in temperature ranges, precipitation, and the frequency of extreme events due to climate change [@ipcc_global_2018; @noonan_situ_2018]. Unpredictable events such as forest fires, floods, and earthquakes also constitute sources of stochasticity.

Generally, events are predictable when (1) they occur with a probability density that is approximately constant over time and space, (2) they occur frequently within an organism's generation time or lifespan, and (3) they occur frequently enough to be expected as normal (e.g., rain in rainforests).^[The variance of a Bernoulli random variable $Y$ is maximized when $P(Y = 1) = p = 0.5 \implies \mathbb V(Y) = p\,(1-p) = 0.25$, and minimized when the event occurs almost never ($p \approx 0$) or or almost always ($p \approx 1$), since now $\mathbb V(Y)\approx 0 (1-0) = 1 (1-1) = 0$. Thus, events which occur extremely rarely, such as meteor impacts, are predictably infrequent and often assumed not to occur.] When an event occurs fairly frequently (e.g., approximately $0.3 \lesssim p \lesssim 0.5$), animals may begin to expect the event to occur and consider it normality (figure \@ref(fig:bernoulli-changing)a), as long as the change in frequency and magnitude is sufficiently gradual. For instance, @lamont_fire_2020 found that serotiny (the storage of seeds in closed cones or fruits which open following a fire) is common in plant populations which suffer fires at least once per lifespan, on average. However, the trait becomes less common if the fires become so common that plants survive more often as resprouters than by producing seeds. If a dangerous event such as fires becomes more frequent, unpredictable, or severe, organisms may store resources in favorable times and locations so they can resist more adverse times, and mobile animals may move to avoid avoid such events altogether [@southwood_habitat_1977; @lindstedt_seasonality_1985]. However, variety in fires may increase environmental heterogeneity and promote biodiversity [@fuhlendorf_application_2004], particularly shortly after fires occur and when fires produce heterogeneous burns [@tingley_pyrodiversity_2016], but the effects of fire can differ between ecosystems [@koerner_small-scale_2013].

### The temporal scale of stochastic events

The timescale over which an event is (un)predictable will also play a key role in determining how species respond, or not, to stochasticity. Adverse events which occur frequently during an organism's generation time or lifespan (e.g., at least twice, on average) may be considered as threats worth preparing for. Stochastic and destructive events which happen frequently can become part of an organism's habitat and life history, so organisms may either adapt to their occurrence and even learn to predict them [@foley_severe_2008], or they may avoid the risk altogether by moving to a new habitat [@southwood_habitat_1977]. If habitats are (or become) unfavorable, animals may move to a new habitat, migrate seasonally [@geremia_migrating_2019], or simply prefer nomadism over range residency [e.g., @nandintsetseg_variability_2019]. It is unclear when animals switch from range residency to nomadism (or vice-versa), but understanding the connection between the two types of movement is important for quantifying the effect of spatiotemporal stochasticity on animal's spatial needs. From a quantitative perspective, the switch is related to an animal's positional autocorrelation over time (also known as home range crossing time, here indicated as $\tau_p$). Animals without a constant home home range (i.e., without a constant centroid) will spend more time away from the overall mean position, so the time required to crossing their entire range time will be large (i.e., on the order of the animal's lifespan).

Adverse events which are too infrequent (e.g., $p \lesssim 0.1$) may not be perceived as a reoccurring threat, so organisms may be unable to adapt appropriately. Instead, highly infrequent events are more likely to perceived as an oddity rather than something worth preparing for. In contrast, highly stochastic events (e.g., $p \approx 0.5$ or if $p$ changes unpredictably) may be perceived as a threat, but organisms may be unable to predict their occurrence, since it would require refined cognitive abilities. For a species or population to adapt to an event, the event must thus occur with sufficient frequency and for a sufficiently long period of time.

<!--
#```{r stochasticity-timescale-figure, fig.cap="Fictitious changes in resource abundance mean (a) and variance (b) over the course of a year. The true trends are indicated by the black line, while the colored lines indicate the estimates perceived based on different levels of adaptability. The dashed vertical line indicates the hypothetical current date, such that any data to the right of the line is unknown to the animals, so estimates on the right of the dashed line are extrapolations. The data were simulated using Gaussian noise to ensure mean-variance independence and modeled using Generalized Additive Models with an identity link function to allow linear responses.", out.width = '0.5\\textwidth', fig.align = 'right', wrapfigure = list('R', 0.5)}
knitr::include_graphics('../../figures/stochasticity-timescale.png')
#```
-->

```{r stochasticity-timescale-figure, eval = FALSE, fig.cap="Fictitious changes in resource abundance mean (a) and variance (b) over the course of a year. The true trends are indicated by the black line, while the colored lines indicate the estimates perceived based on different levels of adaptability. The dashed vertical line indicates the hypothetical current date, such that any data to the right of the line is unknown to the animals, so estimates on the right of the dashed line are extrapolations. The data were simulated using Gaussian noise to ensure mean-variance independence and modeled using Generalized Additive Models with an identity link function to allow linear responses.", out.width = '0.5\\textwidth', fig.align = 'right', wrapfigure = list('R', 0.5)}
knitr::include_graphics('../figures/stochasticity-timescale.png')
```

What an animal perceives as a stochastic process depends on the stochasticity of the process relative to the animal's size, current age (or average lifespan), and adaptability. Generally, small, short-lived, or young organisms will tend to be more sensitive to small-scale (spatial) or short-term (temporal) changes [@southwood_habitat_1977]. Smaller organisms (e.g., mice) are more likely to be be severely impacted by a stochastic event than larger ones (e.g. elephants), since larger organisms can have bigger energy reserves [@lindstedt_seasonality_1985], can move longer distances over short periods of time [@hirt_general_2017], and tend to have longer lifespans, generation times, and developmental periods [@brown_toward_2004], which allow them to develop or memory about the frequency and severity of such events [@foley_severe_2008; @polansky_elucidating_2015]. However, the short generation time and high fertility of smaller *r-selected* species [@pianka_r-_1970; @brown_toward_2004] can allow them to develop traits that increase the chances of survival following an extreme event. Additionally, the effects of size and lifespan on sensitivity are likely nonlinear and correlated, since smaller animals tend to have shorter lives (and vice-versa), and small animals also tend to have lower metabolic rates, which often limit their movement speed, home ranges, and how the animals interact with their ecosystem [@brown_toward_2004]. Thus, processes will have stronger impacts on smaller animals than on bigger ones: The grazing pattern of a bison (*Bison bison*) drastically alters the habitat of most crawling insects, but other grazing mammals would not pay attention to changes in grass length at the same spatial or temporal resolution. Similarly, the timing and quantity of yearly snowfall would be a somewhat predictable and expected event for most adult moose (*Alces alces*), but it may be a shock for many adult zooplankton or a new-born wolf (*Canis lupus*). What one animal may perceive as a single stochastic event (or cycle) may be considered as a series of short and highly stochastic events by another animal. <!-- add empirical examples -->

<!-- add some refs for figure below -->

Figure \@ref(fig:stochasticity-timescale-figure) illustrates the perceived resource availability mean and variance by animals with four different levels of adaptability and how they may predict the mean and variance to change in the future (after the vertical grey line). In the extreme (and likely fictitious) case where an animal does not adapt to the environment (dark blue), it cannot react to or predict changes in mean resource abundance, and thus the perceived variance is inflated whenever the resource abundance does not match the overall mean. Environments appear highly unpredictable to such animals. Animals which can only perceive simple, linear changes in mean resource abundance (orange) perform better as long as resources continue to change linearly in the same direction (i.e. increasing or decreasing). However, they may be surprised when the trend's direction changes, as indicated by the rapid increase in variance in the top rows of figure \@ref(fig:stochasticity-timescale-figure)b. Animals which are able to adapt smoothly (light blue) can predict changes in mean without a significant bias in estimated variance, as long as the process is not highly stochastic (unsurprisingly, see the bottom rows of figure \@ref(fig:stochasticity-timescale-figure)). Finally, animals which adapt rapidly to changing environments may be most able to take advantage of frequent environmental changes, but they may be unable to produce reasonable predictions based on memory [*sensu* @fagan_spatial_2013; @abrahms_memory_2019]. Instead, they depend on constant information and only predict on the most recent information (as indicated by the deviations from the data when predicting into the future).

<!-- The recent shift to more quantitative statistical methods in environmental biology has pushed scientists to begin thinking more critically about data analysis. However, many still operate using methods and frameworks which were necessary with small datasets, but likely become problematic with an abundance of data. For instance, the widespread frequentist approach of hypothesis testing with a significance level of $\alpha = 0.05$ may often be misleading, because the significance of an effect depends on its standard error, which is a function of its sample size, since larger samples will offer a more precise and accurate measurement of the true mean. Similarly, the question of how much data is needed to detect a significant trend [@gray_how_2018] may seem important to some, but I suggest we pay less attention to whether an event or trend is statistically significant over a period of time based on the dichotomy of significance based on an arbitrary significance level [@amrhein_scientists_2019]. Since statistical significance does not only depend on effect size but also sample size (including measurement frequency), high-frequency data is likely to produce statistically significant effects, even in the event of a false positive. Instead, we should focus primarily on whether a change has an important impact on the fitness of the animal(s) of interest [@zuur_mixed_2009]. -->

An animal's ability to alter its behavior (including its movement) in response to environmental conditions is essential in stochastic or changing landscapes. Whether the changes be due to highly variable but (potentially) predictable changes such as the seasons and the weather, or whether they be due to more stochastic events [e.g., natural events such as fires or floods, but also anthropogenic events like oil spills; see @matkin_ongoing_2008], an animal's ability to adapt increases its odds of survival. Generally, temporal variation is more likely to promote plasticity over diversity, since adaptability will likely offer better odds of survival than temporally static diversity in a population or species [@bell_spatial_1993]. @rickbeil_plasticity_2019 showed that the yearly migration of elk (*Cervus canadensis*) depends on variable environmental events and cues such as available forage biomass, hunting pressure, snow fall, and snow melt. Birds have also shown to change their their migration as the climate changes, including large-scale, trans-Saharian migrants [@jonzen_rapid_2006]. And while genetic diversity and polymorphisms also increase the odds of survival for a species [@cavedon_genomic_2022], this project will focus strictly on animal behavior.

In an environment that changes over time, organisms which depend on mutable cycles such as changes in temperature, precipitation, and resource availability are more likely to respond to environmental changes than organisms which depend purely on deterministic cycles (e.g., photoperiod). While this thesis focuses on the movement and spatial use of animals, the adaptability (or lack thereof) of non-animal organisms is also crucial. The ability of most animals to rely on visual cues and move accordingly greatly increases their adaptability and plasticity, particularly for those animals that are able to move large distances over short periods of time (e.g., flying birds and large vertebrates). Although this project will focus on vertebrate animals, such changes are important to consider because the ability of a specialist or obligate symbiont to shift its home range or adapt will likely depend strongly on its associate's ability to move or adapt, too.

<!--
### The spatial scale of stochastic events

To measure the spatial stochasticity of an ecosystem, it is necessary to first define extent of the ecosystem of interest. A lake may seem like a simple and self-contained space to define, but it is often not as simple as deciding the lake's boundaries using a map or satellite pictures. Should one include the shores of the lake? And if so, which region do we consider the lake's shores? Are they the area of land which are currently covered by water, including the sections hit daily by waves, or should we also include the parts of land which are currently not wet but are covered during seasons with more rain? One could base their definition on the species of interest, since coastal areas are not frequented by large fish, but they would likely include them in the ecosystem if they are studying benthic littoral species. Thus, how one measures stochasticity should also depend on which organisms are of most interest.

Since species in a heterogeneous landscape can modify their behavior and move to more favorable locations, spatial variation will favor movement and behavioral adaptations faster than temporal variation will [@bell_spatial_1993].

Transition regions are often have the highest heterogeneity, but, similarly to temporal stochasticity, measures and perceptions of spatial heterogeneity depend on the scale at which they are being considered. The repetitive and cyclical motion of waves may not concern most vertebrates that live along the coast, but it is much more turbulent and chaotic for smaller organisms, such as crustaceans or diatoms. Therefore, the scale at which we consider spatial stochasticity should depend on the size of the organisms of interest as well as the size of their habitat or home range.

Although @bell_spatial_1993 couldn't find a scale at which variance stopped increasing, it seems reasonable to assume that variance cannot increase infinitely. The variance of a finite system (e.g., a lake or a well-defined habitat), should reach a finite maximum somewhere between our smallest scale of interest and the scale of the entire system, even if the maximum is reached when the entire system is considered. This does not imply that a somewhat larger system that contains the first one (e.g. the lake and its coasts) will have the same variance. Variance between lake and coast is high because they are different types of habitats, and the area where they meet (the coast) is potentially even more variable because the mixture of the two creates a third habitat for littoral benthic animals which is subject to high stochasticity due to waves and changing water levels.

The same idea would likely also apply for larger-scale systems, such as continents or a planet. And while stochasticity of a system may also vary over time, it is not reasonable to expect it to increase monotonically through time because that would imply it has been increasing monotonically until the current moment. Still, stochasticity does vary over time, and its estimation depends on the data available, so it may be useful to view it as a random variable with an estimated, conditional posterior distribution through a Bayesian framework [@bolstad_introduction_2017].

<!-- The $\gamma$-variance between spatiotemporal points at a given (spatiotemporal, multidimensional) lag $\vec h$ is calculated as $$\gamma(\vec h) = \frac 12 \mathbb E\left[Z(\vec x + \vec h) - Z(\vec x) \right]^2 = \frac 12 Var\left[Z(\vec x + \vec h) - Z(\vec x) \right]$$ [@bachmaier_variogram_2011]. The $\frac 12$ is because we don't need to repeat each pair (e.g., $V((a, b), (b, a)) = 2 V((a, b))$). View $\gamma(\vec h)$ as a function of $\vec h$ rather than a fixed value. -->

<!--
### Frontiers  Hierarchical, Memory-Based Movement Models for Translocated Elk (Cervus canadensis)  Ecology and Evolution

Refs to check:

* humans, nonhuman primates and other large-brained vertebrates make movement decisions based on spatial representations of their environments (https://www.frontiersin.org/articles/10.3389/fevo.2021.702925/#B50)
* 2010). These representations may allow animals to move directly to important sites in their environment that lie outside of their perceptual range (https://www.frontiersin.org/articles/10.3389/fevo.2021.702925/#B40, https://www.frontiersin.org/articles/10.3389/fevo.2021.702925/#B35)
* Attribute memory, i.e., non-spatial memory, e.g., food type and abundance (https://www.frontiersin.org/articles/10.3389/fevo.2021.702925/#B13)
* Bison remember valuable information about the location and quality of meadows (spatial and attribute memory) and use this information to revisit profitable locations (https://www.frontiersin.org/articles/10.3389/fevo.2021.702925/#B29)
* Roe deer an spatial memory for foraging in absence of territorility (https://www.frontiersin.org/articles/10.3389/fevo.2021.702925/#B41)
* memory in capuchin monkeys (https://www.frontiersin.org/articles/10.3389/fevo.2021.702925/#B8)
* memory in bison (https://www.frontiersin.org/articles/10.3389/fevo.2021.702925/#B18)
* memory in sheep (https://www.frontiersin.org/articles/10.3389/fevo.2021.702925/#B18)
* memory in woodland caribou (https://www.frontiersin.org/articles/10.3389/fevo.2021.702925/#B1)
* memory in chimpanzees (https://www.frontiersin.org/articles/10.3389/fevo.2021.702925/#B20)
* memory constitutes an important mechanism for home range emergence (https://www.frontiersin.org/articles/10.3389/fevo.2021.702925/#B6, Börger et al., 2008; Van Moorter et al., 2009)
-->

<!--
### Urban landscapes and habitat structure

Human activity often fundamentally alters the structure of environments by spatially homogenizing them and imposing temporally heterogeneous and potentially stochastic cycles (e.g., mining, clear-cutting, road traffic, and weekly work schedules). The perception of spatial heterogeneity and cycles in anthropogenic areas varies between species: scavenger animals such as ravens (*Corvus corax*) and raccoons (*Procyon lotor*) often learn to recognize areas that can provide food, such as restaurants or large disposal bins, but other animals may not be able to distinguish between different urban areas. Certain animals have learned to depend on and take advantage of human activity, such as crows who place nuts strategically so that cars will crack them open for them to eat [@nihei_when_2002].
-->

### Spatial needs in stochastic environments

```{r bernoulli-changing, fig.cap="Fictitious example of variation in resource abundance in a heterogeneous and stochastic environment. (a.) Foraging successes (dots) can vary due to various reasons, including differences in competition, predation, and resource-specific trends. Successes most stochastic when the probability of success is approximately 0.5, while they are least stochastic (i.e., most predictable) when they are guaranteed to occur ($p = 1$) or guaranteed to fail ($p = 0$). (b.) Arbitrary definition of $R$ as following a Gamma distribution with shape $k$ and scale $\\theta$, while $S$ follows a Bernoulli distribution with probability of success $p = 0.6$, so successes are not always guaranteed. (c.) Animals living in such an environment cannot always expect each foraging attemp to be successful. Thus, resources may not be accessible even though they are abundant. (d.) Expected resource availability, $\\mathbb E(U)$, is highest in areas with high resource abundance and high probability of success. When possible, animals are likely to rely mostly on predictable, resource-rich areas (top right). Alternatively, they may prefer predictable areas with lower resource abundance (top left) or adapt to high-risk, high-reward areas (bottom right).", out.width = '0.6\\textwidth', fig.align = 'right', wrapfigure = list('R', 0.6)}
knitr::include_graphics('../../figures/bernoulli-changing-p.png')
```

In areas where animals are not guaranteed that the resources they find during one visit will be there the next time (figure \@ref(fig:bernoulli-changing)a), stochasticity will have an appreciable effect on the location's favourableness. Patches with low or high $p$ will be most predictable, since successes can be expected to be very rare (if $p \approx 0$) or very common (if $p \approx 1$). In contrast, patches will be most stochastic when the probabilities of success and failure are approximately the same (i.e., $p \approx 1 - p \implies p \approx 0.5$, see figure \@ref(fig:bernoulli-changing)b). In stochastic habitats, $\mathbb E(U)$ will depend on $\mathbb E(S)$ as well as $\mathbb E(R)$, since $S$ is no longer constant (figure \@ref(fig:bernoulli-changing)c). Now, expected usable resources become

\begin{equation} \label{mean-u-definition}
\mathbb E(U) = \mathbb E(R \, S),
\end{equation}

or

\begin{equation} \label{mean-u-definition-indep}
\mathbb E(U) = \mathbb E(R) \, \mathbb E(S)
\end{equation}

if $R$ and $S$ are independent. This model can be applied to all mobile animals, including herbivores, carnivores, and omnivores. In the case of herbivores, $p$ may indicate the chance of finding good forage, which may be absent if regeneration times are long, if competitors have already exhausted the resource, or following a fire. For carnivores, $p$ may indicate the chance of feeding on prey, which may depend on encountering and killing some first [@suraci_beyond_2022]. However, since $R$ is not limited to energetic resources, $p$ may also indicate the chance of finding water or also a suitable location for a den or nest.

While resource availability is often considered in ecology [@burt_territoriality_1943; @southwood_habitat_1977; @relyea_home_2000; @nilsen_can_2005; @williams-guillen_resource_2006; @rickbeil_plasticity_2019], an environment's heterogeneity (i.e., diversity), stochasticity (i.e., unpredictability), and how the two change over time are rarely accounted for. In addition, environmental stochasticity, including extreme events, can reduce a landscape's energetic balance [@chevin_adaptation_2010], which, in turn, decreases animals' fitness. Therefore, I expect animals living in unpredictable environments to require more space than those in stable environments. Although this hypothesis is supported by a few recent studies [@morellet_seasonality_2013; @nandintsetseg_variability_2019; @riotte-lambert_environmental_2020], many of them are limited in their analytical depth and geographic and taxonomic scales, so the extent to which these preliminary findings can be generalized is still very limited. There thus remains a need for developing a more complete understanding of how animals' spatial needs change with environmental stochasticity. These stresses are compounded by climate change, which exposes species to increasingly common stochastic events [@ipcc_global_2018; @noonan_situ_2018]. Furthermore, anthropogenic structures reduce the habitat available to terrestrial species [@wilson_habitat_2016], who struggle to move in fragmented [@fahrig_non-optimal_2007], human-dominated landscapes [@tucker_moving_2018]. As the impacts of habitat loss and climate change will worsen in the future [@ipcc_global_2018; @hansen_high-resolution_2013], it is imperative that we better understand spatial requirements of taxa to protect wildlife existence and biodiversity. Environmental safeguarding is also essential for Reconciliation with Indigenous People in Canada [@truth_and_reconciliation_commission_of_canada_honouring_2015].

## Interaction effects of resource availability and stochasticity

In the previous section, I mentioned that a model which does not account for environmental variance may be acceptable when $\sqrt{\mathbb V(R)} / \mathbb E(R)$ is low, as in the case of a habitat with high $R$ and $p \approx 1$. However, since maximum resource abundance is constrained by environmental stochasticity [@chevin_adaptation_2010] and resources can be depleted or rendered inaccessible by other individuals [@grant_whether_1993; @jetz_scaling_2004], $\mathbb E(R)$ does not provide a sufficiently complete picture of resource availability in an environment. Thus, the effect of $\mathbb V(R)$ should be included when possible, even when $p \approx 1$ or $p \approx 0$. <!--Spatiotemporally constant and homogeneous regions will allow animals to have a small and dependable home range, while stochastic regions will force animals to have higher spatial needs and possibly store resources for periods of scarcity. Similarly, heterogeneous environments, such as habitats with a high variety of patches, may force animals to move between patches if they cannot depend on a single one. Conversely, if some patches are sufficient and highly valuable, animals may adopt strong defensive behaviors towards the patch [@grant_whether_1993]. Thus, some measure of $\mathbb V(R)$ is needed to understand how stochasticity may affect spatial requirements.-->

Let $H$ indicate the size of an animal's HR.^[We can consider specific utilization quantiles of the HR, such as the core HR, $H_{50\%}$, or the 95% HR, $H_{95\%}$, but for simplicity I will refer to the entirety of the HR with $H$. Statistically, we can imagine $H$ as having a probability distribution with support over the interval from zero (not included) to infinity (also not included), which we can indicate with the notation $H \in (0, \infty)$.] As explained above, $H$ will be higher in regions with lower $\mathbb E(U)$ or higher $\mathbb V(U)$. Figure \@ref(fig:5-5-sims) presents various scenarios with different trends in $\mathbb E(U)$ and $\mathbb V(U)$. Although some of these scenarios may seem overly simplistic, they can help us understand the complex interaction effects of $\mathbb E(U)$ and $\mathbb V(U)$. In regions where $U$ has constant mean and variance, $H$ remains approximately constant, although small oscillations are possible, since $\mathbb V(U) \ne 0$ and thus the environment is still stochastic. When $\mathbb E(U)$ changes over time but $\mathbb V(U)$ remains constant, it is easy to see that $H$ decreases as $\mathbb E(U)$ increases, with changes in $\mathbb E(U)$ having larger effects when $\mathbb E(U)$ is low and smaller effects when $\mathbb E(U)$ is already large. This is best visualized in the scenario in which $\mathbb E(U)$ is increasing linearly while $\mathbb V(U)$ is constant, since decrease in core HR ($H_{50\%}$) and 95% HR ($H_{95\%}$) is decreases over time. Additionally, as $\mathbb E(U)$ increases, the difference between $H_{50\%}$ and $H_{95\%}$ also decreases. Thus, $H_{95\%}$ is more sensitive to changes in $\mathbb E(U)$ than $H_{50\%}$. $H_{95\%}$ is also more sensitive to changes in $\mathbb V(U)$, since changes in $\mathbb V(U)$ cause greater oscillations in $H_{95\%}$ than in $H_{50\%}$.

```{r 5-5-sims, fig.cap="Simulated spatial requirements for animals living in habitats where resource availability vary with constant, linearly increasing, cyclical, drifting, or erratic means and variances. The thick line indicates the mean spatial requirement needed for survival, while the thin line indicates the 95\\% quantile. The thick line can also be interpreted as the animal's core home range, while thin line can be interpreted as the requirements needed for a 95\\% chance of survival, which would be similar to the animals' 95\\% home range. Changes in $\\mathbb V(R)$ have greater impacts when $\\mathbb E(R)$ or $\\mathbb V(R)$ are low.", out.width = '\\textwidth', fig.align = 'right'}
knitr::include_graphics('../../figures/mean-variance-5-by-5-hr-sims.png')
```

Not all 25 scenarios depicted in figure \@ref(fig:5-5-sims) may be realistic, but the trends in $\mathbb E(U)$ and $\mathbb V(U)$, and their impacts on animal space use, are useful examples that can be thought of as simplified scenarios. $\mathbb E(U)$ and $\mathbb V(U)$ may be (approximately) constant in highly homogeneous environments, or environments where resources are sufficiently available that changes in $\mathbb E(U)$ and $\mathbb V(U)$ remain undetected. Although it is impossible for $\mathbb E(U)$ and $\mathbb V(U)$ to increase linearly continuously, such increases may be possible for short periods of time (followed by periods of no change or decrease). Additionally, these examples are important because they demonstrate the relationships between $H$, $\mathbb E(U)$, and $\mathbb V(U)$ in a (relatively) simple scenario. Cyclical oscillations in $\mathbb E(U)$ and $\mathbb V(U)$ may occur in urban environments [@peron_periodic_2017] and as temperatures fluctuate daily and seasonally [@geremia_migrating_2019], while $\mathbb E(U)$ and $\mathbb V(U)$ may drift randomly in highly complex environments with an abundance of competitors, threats, and stochasticity, such as a habitat with a high degree of human alteration and activity. Finally, erratic changes in $\mathbb E(U)$ and $\mathbb V(U)$ may occur in environments where changes are very sudden, such as fire-prone or floor-prone areas, or habitats with drastic human alteration (e.g., a forest which is clear-cut for mining purposes with a subsequent artificial re-forestation). However, if highly stochastic or erratic changes occur frequently, animals are most likely to perceive them as a smooth transition rather a series of small, sudden, changes. Estimating the true trend would often require an excessively high cognitive capacity and an equally unlikely abundance of information. Additionally, although changes in $\mathbb E(U)$ are not due to $\mathbb V(U)$, but often distinguishing between the two is not easy [@steixner-kumar_strategies_2020]. <!-- https://doi.org/10.1080/00207549508930162 ?-->

<!--
```{r 5-5-panel, fig.cap="Simulated resource availability with constant, linearly increasing, cyclical, drifting, and erratic means or variances. The red lines are the means estimated by a Generalized Additive Model fit by the $\\texttt{ggplot2::geom\\_smooth()}$ function, while the shaded areas are the range of $\\pm$ 2 true (i.e, not estimated) standard deviations around the estimated mean.", out.width = '0.5\\textwidth', fig.align = 'right', wrapfigure = list('TR', 0.5)}
knitr::include_graphics('../../figures/mean-variance-5-by-5.png')
```
-->

<!--
```{r 5-5-cv, fig.cap="Standard deviations of the number of patch visits needed for an animal to survive in the habitats detailed in Figure @ref(fig:5-5-panel). Each patch has mean resources as indicated on the left column and variances as indicated in the top row. Note that although the variance in available energy, $\\mathbb V(E)$, is related to the variance in patch visits, the two are not the same. More variable habitats will result in larger spatial requirements, but the relationship is not linear, since habitats with higher mean available energy result in lower spatial requirements. Additionally, the mean available energy and the .", out.width = '0.5\\textwidth', fig.align = 'right', wrapfigure = list('TR', 0.5)}
knitr::include_graphics('../../figures/mean-variance-5-by-5-sd-visits.png')
```
-->

<!-- $HR = a \mathbb E(\text{productivity}) + b \mathbb V(\text{productivity}) - c \mathbb E(\text{metabolic rate}) - d \mathbb E(\text{energetic cost of movement})$ where $a, b, c, d$ are (estimated) coefficients. -->

<!--

## Movement types

### Range residency


### Seasonal migration


### Nomadism

predation is more stochastic than herbibory; predators need to match more cycles, depend on less individuals -> more variable food

@teitelbaum_beyond_2019:
- **Nomadic movement**: with irregular timing and/or direction, producing both within-year and between-year variability in location and movement patterns
- **Nomadic movement** is not the same as **migration**, because migration is predictable and cyclical while nomadism is random in time and space
- "Data from recent developments in animal tracking technology (e.g., longer-lasting and lighter GPS devices) show that species previously considered migrants or range residents can show irregular, often long-distance, movement patterns (flexible foraging movements of leatherback turtles across the north atlantic ocean, To migrate, stay put, or wander Varied movement strategies in bald eagles, Big data analyses reveal patterns and drivers of the movements of southern elephant seals)"

### Edge dynamics

-->

<!--

## Simulations

Include:

* effects of animal mass,
* resistance to/ease of movement (e.g., wolves and clear-cut gas lines)
* "state-space model" with 2 spaces: within a patch (slow-moving) and between patches (faster movement)

See `R` packages for meta-community simulations

-->

## Thesis structure and aims

This thesis aims to quantify how animal's movement and use of space are affected by the abundance of resources (e.g., food, water, breeding grounds) and environmental stochasticity. This work has four key objectives: (i) estimating individuals' spatial requirements in a way which is insensitive to variation in sampling protocols and data quality; (ii) quantifying environmental stochasticity and its effects; (iii) estimating between-species trends using models that are robust to commonly-found issues (e.g., correlations within species); and (iv) understanding how Traditional Indigenous Knowledge can be integrated into large-scale ecological research and conservation planning within a framework that acknowledges both Traditional Indigenous Knowledge and Western science [@kutz_two-eyed_2019]. The present section provides the framework for this thesis, where each chapter is structured as a stand-alone body of work to be submitted for publication. While each chapter is designed to stand alone, together they provide convergent evidence towards the role of stochasticity in shaping animal space use.

To address these over-arching objections, in **Chapter \@ref(var-raster)**, I will produce a global raster of a new environmental stochasticity index, and new quantitative methods for animal movement. This metric will then serve as the basis for my subsequent investigation into the relationship between environmental stochasticity and animal movement.

In **Chapter \@ref(movement)**, I will use simulation studies and an unprecedented and conservation-relevant animal tracking dataset (>1500 animals, 77 globally-distributed species) to investigate how animal spatial needs change with environmental variance.

**Chapter \@ref(synthesis)** summarizes the work presented in this thesis and demonstrates its significance within the larger picture of movement ecology, conservation, and quantitative zoology.

Chapters \@ref(os)-\@ref(timeline) contain various supporting information, namely links to the code and data used in this thesis (**Chapter \@ref(os)**), a table of all abbreviations used in the thesis (**Chapter \@ref(abbreviations)**), a table of all mathematical notations and symbols used in the thesis (**Chapter \@ref(symbols)**), and the tentative timeline (**Chapter \@ref(timeline)**), which will not be present in the final version of the thesis.

**Appendix 1** contains details on further original work. These published works are included as appendix material as I have made substantial contributions, but I am not the lead author. 

<!--chapter:end:10-chapter-1-current-knowledge.Rmd-->

\newpage

# Chapter 2: A new measure of environmental variance {#var-raster}

Notes:

* food quality may have a nonlinear relationship with NDVI, so resource use is also nonlinear over NDVI [@mueller_search_2008]. $\implies$ relationships should be modeled with models that do not assume linear trends but instead allow for smooth, nonlinear ones
* since NDVI accounts for photosynthetic activity, it contains info on phenology and seasonal cycles as well as the damage to vegetation caused by droughts, fires, floods, storms, blizzards, and frosts [@pettorelli_normalized_2011]. Thus, we don't need to account for these extreme and rare events because their effects on vegetation are already accounted for (and are what likely matters most).
* NDVI as a proxy to estimate frequency of extreme events [e.g., fires, floods, droughts; see @]
* bisons' grazing reduces fire risk and keeps nitrogen in the soil [http://refhub.elsevier.com/S0169-5347(19)30052-7/sbref0480]

Whether an animal is affected by or can perceive environmental variance depends strongly on the spatiotemporal scale of the process(es) involved. Organisms are most affected by stochastic events and processes which occur on time scales which are in the order of the organisms' life spans or generation times [@southwood_habitat_1977]. Weekly heavy rains which alter a lake's salinity are more likely to affect an individual than a multi-centennial drought, and the high salinity that follows the drought may be perceived as the (stressful) standard by individuals which were born during or following the drought. In contrast, organisms can adapt to unpredictable heavy rains if they occur on a daily frequency. However, stochastic processes and events which occur on time scales that are longer than an organism's lifespan may still cause significant effects on a population's fitness and stability. Droughts which occur on the time scale of centuries or millennia [@haig_assessment_2013] are unlikely to affect organisms directly, but such events could still alter the population's habitat or breeding grounds enough to cause a population collapse or prevent individuals from reproducing in their habitual breeding region (or reproduce altogether).

Thus, the scale at which we quantify variance should depend on the spatiotemporal scale and sensitivity of the animals being studied. Since this project focuses on medium to large animals, I will focus on processes and events which occur on the temporal scale of hours to decades and spatial scale of meters to kilometers. I will assume small-scale variances such as heterogeneity in grass density at the centimeter scale or fluctuations in temperature over the span of a few minutes have little to no (measurable) effect on the spatial needs of the animals which I will be studying. Even if such small-scale variances had an effect, such an effect would be hard to detect or quantify because: (1) the effect size would be small (so large amounts of data would be necessary for an appreciable result), and (2) the uncertainty in the tracking data limits the precision at which one is able to detect changes in movement in response to such small variation (figure \@ref(fig:heterogeneity)). Thus, it seems reasonable to quantify environmental variance at the scale of minutes to days and meters to kilometers.

```{r heterogeneity, fig.cap="(a.) Fictitious means of an arbitrary random variable (e.g., resource abundance, productivity, temperature, precipitation) in a two-dimensional space. The mean value varies within small-scale patches (left), between small-scale patches (center) and large scale-patches (right). Thus, the perceived means depend on the spatial scale at which the observer can detect differences. (b.) Environmental heterogeneity detected at different degrees of precision. Wider regions have a wider range of means, which results in higher heterogeneity. Thus, each cell in the left panel represents the heterogeneity of the 100 pixels in the cell, while the cells in the central panel indicate the heterogeneity in the 10,000 cells in each of the larger cells, and the right panel indicates the heterogeneity in all 90,000 pixels. (c.) Fictitious, scale-dependent, perceived heterogeneity. The left panel is calculated as in row (b), while heterogeneity in the central and right panels are calculated on the means in the central and right panels in row (a), respectively. Perceived heterogeneity is lower than true heterogeneity because heterogeneity is lost when averaging values.", out.width = '0.6\\textwidth', fig.align = 'right', wrapfigure = list('R', 0.6)}
knitr::include_graphics('../../figures/spatial-heterogeneity.png')
```

To my knowledge, there currently is no large-scale measurement of environmental variance. Producing a worldwide raster of such a measure would allow researchers to estimate the spatiotemporal variance of an animal's habitat and better understand not only how heterogeneity and unpredictability affect its home range, but also when and why animals decide to migrate or become nomadic, and many other behaviors or decisions, such as the timing of reproduction, when animals decide to defend territory and resources, and more. Some measures of environmental productivity and heterogeneity already exist, such as the machine learning human footprint index (ml-HFI) produced by @keys_machine-learning_2021 and the Normalized Difference Vegetation Index [NDVI, @pettorelli_normalized_2011]. However, none of these indices provides a comprehensive measure of environmental variance over the years. For instance, the ml-HFI is a temporally static raster, so it prevents us from accounting for temporal changes in anthropogenic habitat alteration, and neither the ml-HFI and the NDVI account for the frequency of events. 

<!--
when was NDVI calculated globally? do we need to extrapolate for years prior to 1999? if so, we should check predictions for spatiotemporal accuracy

quantify levels and stability of green light wave (see NDVI) with and without human modification/activity. model interaction of NDVI and ml-HFI? but risk over-fitting and creating spurious correlations and models hard to interpret. -->


A measure of environmental variance should thus account for the spatiotemporal variance in frequent events (e.g., precipitation) and continuous processes (e.g., temperature) as well as the frequency of extreme and rare events (e.g., fires, cyclones). How the frequency and average intensity of events are estimated depends on the event(s) considered. Processes for which we have an abundance of global-scale data, such as daily air temperature and precipitation can be included as raw data, and their variances can be estimated using smooth location-scale models, such as GAMs with appropriate conditional distributions [i.e., Gaussian location-scale for temperature and Gamma location-scale for precipitation; see @stasinopoulos_generalized_2007; @umlauf_bamlss_2018]. In contrast, the frequency of rare events should be modeled with more smooth (i.e., less flexible) models, since the low data availability does not allow us to use models with high degrees of freedom [i.e., very wiggly predictors; see @simpson_modelling_2018].

## Quantifying environmental variance

Let $Z$ indicate the measure of environmental variance used in this thesis. $Z$ should contain information on a multitude of sources of environmental variance, including daily, seasonal, and spatial variance (e.g., changes in temperature, precipitation, and photoperiod, NDVI), inter-annual variance [e.g., climatic oscillations such as the El Niño-Souther Oscillation, see @rasmusson_meteorological_1983; and anthropogenic climate change, see @ipcc_global_2018], and the frequency of extreme events, such as fires, floods, and droughts. The variation from most sources can be modeled using a Generalized Additive Model [GAM, see @wood_fast_2011; @wood_generalized_2017] for location and scale [GAMLS, see @stasinopoulos_generalized_2007] with an appropriate distribution.^[For example, temperature (measured in $^\circ$C) could be modeled using a Gaussian distribution since it can take both positive and negative values, while precipitation is strictly positive and continuous, so a Gamma distribution would be appropriate. A beta distribution could be used to model the proportion of a day with light (e.g., hours of sunlight divided by 24, which would result in a proportion in the interval $[0, 1]$) and NDVI [@pettorelli_normalized_2011], since it can easily be transformed from the interval $[-1, 1]$ to $[0, 1]$ using the function $g(x) = (x + 1)/2$. Note that it is acceptable to transform the models' responses (light per day and NDVI) since both transformations ($f(x) = x / 24$ and $g(x) = (x + 1)/2$) are linear (i.e. only comprised of addition and multiplication), so Jensen's inequality [@jensen_sur_1906] does not apply here.] Similarly, the frequency of extreme events can be estimated from the estimated probability of occurrence of the event. We can estimate such probability using a piece-wise exponential additive model [PAM; see @bender_pammtools_2018], which is a GAM for time-to-event data.

<!-- Many sources of variation are likely correlated (e.g., temperature, precipitation, occurrence of fires), so it may not be necessary to include many sources of variation in $Z$ to obtain an appreciable estimate. However, by using flexible yet penalized models such as GAMs and PAMs, I can include many sources of variation without risking model over-fitting and inflated coefficients. -->

Since each source of variation will affect animals to different degrees and will have different units (e.g., $^\circ$C, milliliters, hours) or no units (e.g., NDVI, frequency of events), and different ranges (e.g., $(-\infty, \infty)$ for temperature, $[0, \infty)$ for precipitation, $[0, 1]$ for fraction of daylight, and $[-1, 1]$ for NDVI), it would not be appropriate to define $Z$ as the sum of each variance. Instead, a weighted average of the (scaled) variances or coefficients of variation (i.e., standard deviation over mean) may be more appropriate. Weights and scaling could be informed by an algorithm similar to a principal components analysis (PCA) that varies over time and space. However, the more abstract $Z$ is, the less interpretable it becomes, so results based on $Z$ should be interpreted carefully since a different set of variables or different weights may result in different conclusions. Therefore, although using few sources of variance will fail to account for some factors, the results may be easier to understand and apply. This would particularly be the case if few variables accounted for most environmental variance.

Since the variance of a process has a lower limit (0) but does not necessarily have an upper limit, it seems reasonable to model $Z$ using a Gamma distribution for the model residuals. Estimating $\mathbb E(Z)$ over time and space will require various measures of spatiotemporal heterogeneity and stochasticity. The measure should vary over time and space, such that: (1) $\mathbb E(Z)$ changes over time, (2) individual location can have different values of $\mathbb E(Z)$, and (3) the change in $\mathbb E(Z)$ over time can also differ between habitats, since it may change faster in some habitats than others, and the shape and direction of the change may also differ between locations. Thus, the model used to estimate environmental variance should have 3 main terms: (1) a term for the global average over time ($t$), (2) a term for the global average over space (longitude, $s_x$, and latitude, $s_y$), and (3) an interaction term of space and time that allows locations to deviate from the global average temporal and spatial trends:

\begin{equation} \label{variance-model}
\mathbb E(Z) = f_1(t) + f_2(s_1, s_2) + f_3(t, s_1, s_2)
\end{equation}

The terms should be smooth and sufficiently complex to maximize model flexibility, but the wiggliness should also be penalized to avoiding over-fitting the data [@simpson_modelling_2018]. Thus, it seems appropriate to estimate the average $Z$ over space and time using a GAM, which can be fit easily using the `mgcv` [@wood_generalized_2017] package for `R` [@r_core_team_r_2021]. The smooth of time, $f_1(t)$ could be modeled with a thin-plate spline smooth [@wood_thin_2003; @simpson_modelling_2018], while the two-dimensional spatial term, $f_2(s_1, s_2)$, should use a two-dimensional spline. While splines on the sphere [@wahba_spline_1981] would provide a good approximation for the shape of the earth, $Z$ will likely be constrained to terrestrial or freshwater habitats, so Duchon splines are a better alternative [@duchon_splines_1977]. Duchon splines are well-behaved as they move away from the support of the data, so they are less likely to produce questionable edge behavior. Finally, the interaction term $f_3(t, s_1, s_2)$ can be modeled as the tensor interaction product [@wood_straightforward_2013] of time and space, with a thin-plate spline smooth for time and a Duchon spline for space. To reduce computation time, the GAM will be fit using the `bam()` function from the `mgcv` package, which fits models similarly to `mgcv::gam()` but is specific for fitting models to very large datasets. `bam()` allows model fitting using fast restricted maximum likelihood and discretized covariates [@li_faster_2020; @wood_generalized_2017-1; @wood_generalized_2015], with no appreciable loss to model fit.

<!-- could add mention to the study that used the geometric mean as a simple option -->

<!--chapter:end:20-chapter-2-stochasticity-raster.Rmd-->

\newpage

# Chapter 3: Movement analyses {#movement}

[@noonan_scale-insensitive_2019]
* need $\Delta t < \tau_v$. If $\Delta t > \tau_v$, speed estimates become unreliable. e.g., estimating velocities from the movement of a pika that changes direction every 30 seconds will require more frequent sampling, while sampling the movement of a migrating goose that flies in a straight line for an hour or more [@ref] will require less frequent measurements. If $\Delta t > 3 \tau_v$, since directional persistence decays exponentially at rate $1/\tau_v$, the time required for the proportion of the original velocity autocorrelation to decay to statistically insignificant levels [e.g., $\alpha > 0.05$, but see  @amrhein_scientists_2019] is $\tau_\alpha = \tau_v \log(1/\alpha) \implies \tau_{0.05} = \tau_v \log(1/0.05) \approx 3$
* the scale sensitivity of discrete movement models causes them to under-estimate speed if the sampling is too coarse and over-estimate speed if the sampling is too fine
* continuous-time estimates of speed and distance require proper error calibration, otherwise the models will produce very biased estimates (even worse than SLD estimates)
* SLD is ridiculously sensitive to data frequency
* good estimates of speed require $\Delta t << 3 \tau_v$ and a high $N_{velocity}$, which are the measurements with independent velocities (i.e., $t_i - t_{i-1} \gtrsim 3 \tau_v$) 

* dingos that feed on human scraps have a smaller HR:  https://doi.org/10.1111/j.1600-0587.2013.00056.x

This chapter will contain the analyses of the animal movement dataset which is central to this thesis, including how the animals' spatial needs and behaviors were quantified. It will then use the results and products from the previous chapters (namely the movement simulations and the raster of environmental variance) to estimate the effects of resource abundance and environmental variance on animals' spatial needs. Animal movement data will be modeled using continuous-time (stochastic) movement models (CTMMs), which assume movement data to being generated from stochastic process with spatiotemporal autocorrelation. In contrast, most models used in movement ecology [e.g., minimum convex polygon, @mohr_table_1947; kernel density estimation, @worton_kernel_1989; k-local convex hull, @getz_local_2004] assume movement processes to be temporally discrete (e.g., an animal moves at the same time every day) and spatiotemporally independent (i.e., the current position of an animal now does not affect where it will be). The assumption of temporally discrete observations can be satisfied easily with a consistent data collection procedure (or data thinning), while the assumption of spatiotemporal independence may hold if the time between observations is particularly long (relative to the animal's $\tau_p$). However, it is not hard to demonstrate that animal movement is not a discrete process, nor is it spatiotemporally independent: The position an animal is in at any given moment depends on where it was before, and it will affect where it will be later. Thus, when observations are taken with sufficient frequency, neither assumption is valid.

While the assumptions of discrete and independent observations may be acceptable (and even necessary) for small datasets which do not contain sufficient information to estimate autocorrelation structures [@de_solla_eliminating_1999; @blundell_linear_2001; @fieberg_kernel_2007], they are not appropriate for any high-frequency dataset, since such data is likely autocorrelated [@noonan_comprehensive_2019]. This is particularly the case with high-frequency data, since modern animal tracking datasets often have a lag-1 autocorrelation $\approx 1$ (i.e., two consecutive observations are almost identical). In such cases, the sample size (i.e., the number of observations, often indicated as $n$) of a dataset is not representative of the amount of information the dataset includes, so the concept of an *effective* sample size is preferred (indicated here as $n_{eff}$). The effective sample size indicates the estimated number of independent observations, so it decreases as autocorrelation increases. When autocorrelation is not accounted for and the data is highly autocorrelated (which implies $n_{eff}$ is much smaller that $n$), any estimated measure of uncertainty is underestimated, so home range estimates tend to be artificially small [@noonan_comprehensive_2019].

However, high autocorrelation is not an issue, as long as it is accounted for. Instead, it provides a more realistic representation of animal movement. Coarsening data until sampling occurs to regular intervals so autocorrelation is (arbitrarily) statistically not significant removes important properties of the dataset and nullifies great part of the benefits achieved with recent improvements in tracking technologies. Thus, it is increasingly important to model animal movement data using models that (1) do not assume data is regularly sampled, and (2) account for the spatiotemporal autocorrelation within the data.

Continuous-time (stochastic) movement models (CTMMs) such as Ornstein-Uhlenbeck (OU) and OU foraging (OUF) models relax the assumption of spatiotemporal independence by accounting for positional autocorrelation (OU and OUF models) and directional (i.e., velocity) autocorrelation (OUF models only). This allows the models to estimate the animal's average home range crossing time (OU and OUF) and the animal's average directional persistence (OUF only). @peron_periodic_2017 provide additional information OU and OUF models and how to interpret them while also demonstrating how to use high-frequency movement data can help detect small-scale cycles, such as patterns that occur daily or weekly.

In this thesis, each animal's movement will be modeled using individual CTMMs, while the effects of resource abundance and environmental variance on various movement parameters (HR size, average speed, $\tau_p$, $\tau_v$) will be estimated using Hierarchical Generalized Additive Models [HGAMs, see @pedersen_hierarchical_2019]. While it would be ideal to fit all movement data with a single hierarchical CTMM to use a single likelihood distribution and estimate common trends between animals and variances between animals' movement parameters, the `ctmm` package does not currently support hierarchical models. However, uncertainty uncertainty in parameter estimates can still be accounted for in the HGAM by using some function of the parameters' standard error or $n_{eff}$ as a weight (such that estimates with less certainty or independent data have less importance).

```{r stoch-example-figure, fig.align='center', echo=FALSE, fig.cap = "Simulations depicting the effects of resource availability and stochasticity on spatial needs. Animals moved from the circles to nearby tiles until satiated. The labels indicate how many steps animals took to reach satiety. Note the higher spatial needs of animals in more unpredictable or resource-scarce environments. Resources were generated using a gamma random variable parameterized by independent mean and variance paramters, which represented the resource abundance and environmental stochasticity, respectively, even though the two are likely correlated in nature.", out.width = '0.5\\textwidth', fig.align = 'right', wrapfigure = list('R', 0.5)}
knitr::include_graphics('../../figures/first-presentation/stochasticity-figure-light.png')
```

I expect home range size to decrease with resource abundance and increase with environmental variance, although environmental variance may have the most effect when $R$ is low and a much lower effect when $R$ is high (figure \@ref(fig:stoch-example-figure). Thus, the HGAM will include (1) a smooth predictor for resource abundance, (2) a smooth predictor of environmental variance, and (3) an smooth interaction effect of the two. The smooth interaction effect will allow the effect of environmental variance to depend on resource abundance (and vice-versa). Additionally, I plan to account for common trends between taxonomic groups by allowing each smooth effect to vary between taxonomic groups, but with a common degree of smoothness between groups [@pedersen_hierarchical_2019]. If there is no evidence of bias arising from the opportunistic sampling of the dataset, I may also include spatiotemporal smooth terms to allow the effects of resource abundance and environmental variance to change over time and space. However, it may be more appropriate to fit such a model to a subset of the data to minimize sampling bias.

<!--chapter:end:30-chapter-3-movement-analyses.Rmd-->

\newpage

# Chapter 4: Synthesis {#synthesis}

<!--
- why is this work important? 
- so what?
- now what?
-->

The effect of resource abundance on animals' spatial needs has been studied in multiple species, but little work has been done to estimate common trends between various taxonomic groups. Additionally, the spatiotemporal variability of the ecosystems animals live in is rarely taken into consideration. This thesis will provide estimates of how the spatial needs and behaviors of animals are affected by resource abundance and environmental variance.

**Chapter 1** will contain numerical simulations of how animals' movement and space use are affected by resource abundance and environmental variance, as well as a literature review that will help define the models used to produce such simulations. The review will also help determine which sources of environmental variance should be included in the global stochasticity raster presented in **Chapter \@ref(var-raster)**. Finally, in **Chapter \@ref(movement)**, I will use simulation studies and an unprecedented and conservation-relevant animal tracking dataset (>1500 animals, 77 globally-distributed species) to investigate how animals' spatial needs and behavior change with environmental variance.

The findings produced by this thesis will offer important considerations regarding the amount and quality of habitat animals require to survive in heterogeneous, changing, or stochastic habitats. Although the focus of this thesis will be on (large) mammals (and thus conclusions may not be applicable to other animals), the methods presented here can easily be applied to non-mammalian data. In addition, the global measure of environmental variance produced in **Chapter \@ref(var-raster)** will be designed so it is applicable to other fields of biology other than animal movement ecology, including animal behavior and phenology (including plant phenology).

<!-- Aim for ca. 1/2 a page on how you expect to tie everything together. -->

<!-- tie the foreword to the summary -->

<!--chapter:end:40-chapter-4-synthesis.Rmd-->

\newpage

# Open and transparent science: Code and data availability {#os}

All code and figures used in this project are available at the GitHub repository located at [https://github.com/StefanoMezzini/hr-environ-stoch-masters](https://github.com/StefanoMezzini/hr-environ-stoch-masters). The repository currently does not include the animal movement data that will be used, which is available on Movebank and will be linked in future R scripts in the repository. The tapir movement data used for figure \@ref(fig:tapir-hr) is available in the `data` folder at [https://github.com/StefanoMezzini/tapirs](https://github.com/StefanoMezzini/tapirs).

All scripts include comments to help people replicate the analysis, but they do assume some basic knowledge of `R` (including referring to help files and vignettes). Comments and requests regarding the project can be placed in the repository as issues.

<!--chapter:end:43-open-science.Rmd-->

\newpage

# List of abbreviations used {#abbreviations}

```{r}
library('dplyr')
readr::read_csv('abbreviations.csv', col_types = 'cc') %>%
  arrange(Abbreviation) %>%
  knitr::kable(format = 'pipe', caption = 'A list of all abbreviations and acronyms used in the thesis.')
```

<!--chapter:end:46-abbreviations.Rmd-->

\newpage

# List of notations and symbols used {#symbols}

```{r}
library('dplyr')
library('stringr') # for basic but convenient string manipulation
readr::read_csv('symbols.csv', col_types = 'cc') %>%
  mutate(Symbol_2 = Symbol %>%
           str_replace(pattern = ' ', replacement = '') %>%
           str_replace(pattern = '\\\\', replacement = '') %>%
           str_replace(pattern = '\\$', replacement = '') %>%
           str_replace(pattern = '\\mathbb', replacement = '')) %>%
  arrange(Symbol_2) %>%
  select(-Symbol_2) %>%
  knitr::kable(format = 'pipe', caption = 'A list of all mathematical notations and symbols used in the thesis.')
```

<!--chapter:end:47-symbols.Rmd-->

\newpage

# Project timeline {#timeline}

```{r, echo = FALSE, fig.cap='Visual representation of the estimated timeline for my Master\'s project.', fig.width=14, fig.height=8, message=FALSE, out.width='100%'}
library('tibble')    # for fancy data frames
library('dplyr')     # for piping and data wrangling
library('lubridate') # for working with dates
library('stringi')   # for working with character strings
library('ggplot2')   # for plotting the timeline
# library('ggrepel')   # for non-overlapping ggplot labels
theme_set(theme_classic() +
            theme(axis.line.y = element_blank(),
                  legend.position = 'none'))

# curstom color-vision deficient palette
pal <- c('#4477AA', '#ff8c00', '#66CCEE', '#009900',
                  '#CCBB44', '#AA3377', '#EE6677', '#BBBBBB')
                  
t_breaks <- tibble(dates = c('2021-09-01',
                             '2022-01-01', '2022-05-01', '2022-09-01',
                             '2023-01-01', '2023-05-01', '2023-09-01',
                             '2024-01-01', '2024-05-01', '2024-09-01',
                             '2025-01-01', '2025-05-01', '2023-09-01') %>%
                     date(),
                   dec = decimal_date(dates),
                   strings = paste(month.abb[month(dates)], year(dates)))

tasks <-
  readr::read_csv('timeline.csv', col_types = 'ccDD') %>%
  mutate(header = purrr::map2_lgl(section, task, grepl),
         section = factor(section,
                          levels = c('Other', 'Chapter 5', 'Chapter 4',
                                     'Chapter 3', 'Chapter 2', 'Chapter 1',
                                     'Preparatory', 'Coursework'))) %>%
  arrange(section, desc(start), desc(end)) %>%
  mutate(dec_start = lubridate::decimal_date(start),
         dec_end = lubridate::decimal_date(end),
         dec_mid = purrr::map2_dbl(dec_start, dec_end, \(x, y) (x + y) / 2),
         task = factor(task, levels = unique(task)),
         id = 1:n(),
         completed = end <= Sys.Date(),
         # task = stri_replace_all(task, regex = ':', replacement = ':\n'),
         # re-format all special characters (only needed if parse = TRUE)
         # task = stri_replace_all(task, regex = ' ', replacement = '~'),
         # task = stri_replace_all(task, regex = '\'', replacement = "\\'"),
         # task = stri_replace_all(task, regex = '~in~', replacement='~\'in\'~'),
         # task = stri_replace_all(task, regex = ',', replacement = ''),
         # task = stri_replace_all(task, regex ='for~', replacement='\'for\'~'),
         # make headers bold (removed because numbers cannot be bold)
         #task = if_else(header, paste0('bold(', task, ')'), task),
  )

# tasks %>%
#   transmute(Task = task, `Start date` = start, `End date` = end) %>%
#   knitr::kable(caption = 'Estimated timeline for my Master\'s project.')
ggplot(tasks, aes(y = id)) +
  geom_hline(aes(yintercept = id + 0.5), filter(tasks, header), alpha = 0.15) +
  geom_vline(xintercept = decimal_date(Sys.Date()), lty = 'dashed', alpha = 0.5) +
  geom_errorbar(aes(xmin = dec_start, xmax = dec_end, color = section),
                width = 0, linewidth = 2, alpha = 0.75) +
  #' use `ggrepel::geom_label_repel()` for repelling labels
  geom_text(aes(2020.2, label = task, color = header), hjust = 'left',
            size = 3, parse = FALSE) +
  scale_x_continuous(NULL, breaks = t_breaks$dec, labels = t_breaks$strings,
                     expand = c(0, 0)) +
  scale_y_continuous(NULL, breaks = NULL) +
  scale_color_manual(NULL, values = c('black', 'grey40', pal),
                     breaks = c(TRUE, FALSE, levels(tasks$section)))
```

## Progress to date

```{r, eval = FALSE}
filter(tasks, completed) %>%
  pull(task) %>%
  as.character() %>%
  cat(sep = '\n')
```

- Created and organized the GitHub repository  ([https://github.com/StefanoMezzini/hr-environ-stoch-masters](https://github.com/StefanoMezzini/hr-environ-stoch-masters));
- Completed all coursework necessary for a Master's degree;
- Reviewed literature and have begun making theoretical predictions;
- Living Data Project Working group: calculated new Canadian Living Planet Index (cLPI);
- Data analyst: estimated effects of human activity on tapir movement using `ctmm` and `mgcv`. The manuscript has been accepted and is in press (preprint is available at [https://www.biorxiv.org/content/10.1101/2021.11.12.468362v1](https://www.biorxiv.org/content/10.1101/2021.11.12.468362v1), and the code and data are available at [https://github.com/StefanoMezzini/tapirs](https://github.com/StefanoMezzini/tapirs);
- Data analyst: estimated changes paleolimnological time series from endorheic lakes due to 8-m lake-level variation using Hierarchical Generalized Additive Models (HGAMs) and location-scale HGAMs fit with `mgcv`. The manuscript is available at [https://doi.org/10.1002/lno.12054](https://doi.org/10.1002/lno.12054), while code and data are available at [https://github.com/simpson-lab/kenosee-white-bear](https://github.com/simpson-lab/kenosee-white-bear);
- Presented the background theory behind the thesis and some simulations as a guest lecturer in Dr. Noonan's BIOL 417 course (Evolutionary Ecology).

<!--chapter:end:48-timeline.Rmd-->

\newpage

# Bibliography {-}

<div id="refs"></div>

<!--chapter:end:50-bibliography.Rmd-->

\newpage

# Appendix 1: Manuscripts contributed to during the degree {-}

<!-- Kenosee and White Bear paper -->
\includepdf[pages={-}]{manuscripts/Limnology Oceanography - 2022 - Bjorndahl - Abrupt changes in the physical and biological structure of endorheic upland.pdf}

<!-- tapir paper -->
\includepdf[pages={-}]{manuscripts/Movement ecology of vulnerable lowland tapirs between areas of varying human disturbance.pdf}

<!-- LDP traits paper -->
\includepdf[pages={-}]{manuscripts/facets-2022-0063_Proof_hi.pdf}

<!--chapter:end:51-appendix-1.Rmd-->

